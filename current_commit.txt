Group CategoryTable by subject (not class)

* move missing/zero grade code into separate function
* group missing/zero grades by subject (not class)
